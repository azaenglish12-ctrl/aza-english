<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ìì˜ì–´í•™ì› - ì„±ì  ì¡°íšŒ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        /* ë¡œê·¸ì¸ í™”ë©´ */
        .login-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            margin: 100px auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        .login-card h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        .login-card p {
            color: #666;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        /* ëŒ€ì‹œë³´ë“œ */
        .dashboard {
            display: none;
        }
        .header-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        /* ë¡œê³  ì¶”ê°€ */
        .header-logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        .logo-text {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .logo-emoji {
            font-size: 2rem;
        }
        .student-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .student-name {
            font-size: 2rem;
            color: #333;
            font-weight: 700;
        }
        .student-class {
            color: #666;
            margin-top: 5px;
            font-size: 1.1rem;
        }
        .logout-btn {
            padding: 10px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
        }
        /* ì›” ì„ íƒ í•„í„° */
        .filter-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .filter-group label {
            font-weight: 600;
            color: #666;
        }
        .filter-select {
            padding: 8px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            background: white;
        }
        .filter-select:focus {
            outline: none;
            border-color: #667eea;
        }
        /* í†µê³„ ì¹´ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .stat-detail {
            color: #999;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .chart-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }
        .chart-container {
            position: relative;
            height: 300px;
        }
        /* ì„±ì  í…Œì´ë¸” - ëª¨ë°”ì¼ ìµœì í™” */
        .table-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ì¶”ê°€ */
        }
        .table-wrapper {
            min-width: 500px; /* ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background: #f8f9fa;
            padding: 10px 8px; /* íŒ¨ë”© ì¤„ì„ */
            text-align: left;
            font-weight: 600;
            color: #666;
            font-size: 0.85rem; /* í°íŠ¸ í¬ê¸° ì¤„ì„ */
            white-space: nowrap; /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
        }
        td {
            padding: 10px 8px; /* íŒ¨ë”© ì¤„ì„ */
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.85rem; /* í°íŠ¸ í¬ê¸° ì¤„ì„ */
            white-space: nowrap; /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
        }
        .score-badge {
            display: inline-block;
            padding: 3px 8px; /* íŒ¨ë”© ì¤„ì„ */
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.8rem; /* í°íŠ¸ í¬ê¸° ì¤„ì„ */
            white-space: nowrap; /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
        }
        .score-pass {
            background: #d4edda;
            color: #155724;
        }
        .score-fail {
            background: #f8d7da;
            color: #721c24;
        }
        /* ì¶œì„ ë‹¬ë ¥ ìŠ¤íƒ€ì¼ */
        .calendar-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        .calendar-nav button {
            padding: 8px 15px;
            background: #f5f5f5;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        .calendar-nav button:hover {
            background: #e0e0e0;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        .calendar-day-header {
            text-align: center;
            font-weight: 700;
            color: #666;
            padding: 10px;
            font-size: 0.9rem;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .calendar-day:hover {
            transform: scale(1.05);
        }
        .calendar-day.empty {
            background: transparent;
            cursor: default;
        }
        .calendar-day.empty:hover {
            transform: none;
        }
        .calendar-day.attend {
            background: #4caf50;
            color: white;
        }
        .calendar-day.absent {
            background: #f44336;
            color: white;
        }
        .calendar-day.late {
            background: #ffc107;
            color: white;
        }
        .calendar-day.no-class {
            background: #e0e0e0;
            color: #999;
        }
        .calendar-legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #666;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ì¶”ê°€ ê°œì„  */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .student-info {
                flex-direction: column;
                gap: 20px;
            }
            .chart-card {
                padding: 20px;
            }
            .calendar-grid {
                gap: 4px;
            }
            .calendar-day {
                font-size: 0.85rem; /* ëª¨ë°”ì¼ì—ì„œ í°íŠ¸ í¬ê¸° ì¤„ì„ */
            }
            .header-logo {
                flex-direction: column;
                text-align: center;
            }
            /* í…Œì´ë¸” ëª¨ë°”ì¼ ìµœì í™” */
            .table-card {
                padding: 15px;
            }
            th, td {
                padding: 8px 5px; /* ëª¨ë°”ì¼ì—ì„œ íŒ¨ë”© ë” ì¤„ì„ */
                font-size: 0.75rem; /* ëª¨ë°”ì¼ì—ì„œ í°íŠ¸ í¬ê¸° ë” ì¤„ì„ */
            }
            .score-badge {
                font-size: 0.7rem; /* ëª¨ë°”ì¼ì—ì„œ ë±ƒì§€ í¬ê¸° ë” ì¤„ì„ */
                padding: 2px 6px;
            }
            .chart-title {
                font-size: 1.2rem;
            }
        }
        /* ì‘ì€ í™”ë©´ìš© ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        @media (max-width: 480px) {
            .table-card {
                padding: 10px;
            }
            th {
                font-size: 0.7rem;
            }
            td {
                font-size: 0.7rem;
            }
        }




/* ë„¤ì˜¨ ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
.loading-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 300px;
}

.pulse-loader {
    position: relative;
    width: 100px;
    height: 100px;
    margin: 0 auto 30px;
}

.pulse-loader::before,
.pulse-loader::after {
    content: '';
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 3px solid rgba(255, 255, 255, 0.5);
    animation: pulse 2s ease-in-out infinite;
}

.pulse-loader::after {
    animation-delay: 1s;
}

@keyframes pulse {
    0%, 100% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 1;
    }
    50% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
    }
}

.loading-text {
    font-size: 1.2rem;
    color: white;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    animation: glow 2s ease-in-out infinite;
}

@keyframes glow {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

.loading-dots {
    display: inline-block;
}

.loading-dots::after {
    content: '';
    animation: dots 1.5s infinite;
}

@keyframes dots {
    0% { content: ''; }
    25% { content: '.'; }
    50% { content: '..'; }
    75% { content: '...'; }
}

.loading-progress {
    width: 200px;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    margin: 20px auto;
    overflow: hidden;
}

.loading-progress-bar {
    height: 100%;
    background: white;
    border-radius: 2px;
    animation: progress 2s ease-in-out infinite;
}

@keyframes progress {
    0% { width: 0%; }
    50% { width: 70%; }
    100% { width: 100%; }
}


/* ìˆœìœ„ í‘œì‹œ ìŠ¤íƒ€ì¼ */
.ranking-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 25px;
    margin-bottom: 30px;
    color: white;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}

.ranking-title {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 20px;
    text-align: center;
    opacity: 0.95;
}

.ranking-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.ranking-card {
    background: rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    padding: 15px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    text-align: center;
    position: relative;
}

.ranking-label {
    font-size: 0.9rem;
    opacity: 0.9;
    margin-bottom: 8px;
}

.ranking-value {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 5px;
}

.ranking-name {
    font-size: 1rem;
    opacity: 0.85;
}

.trophy-icon {
    font-size: 2rem;
    margin-bottom: 10px;
}

/* 1ìœ„ íŠ¹ë³„ íš¨ê³¼ */
.ranking-card.is-champion {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 255, 255, 0.2));
    border: 2px solid gold;
    overflow: hidden;
    animation: champion-glow 2s ease-in-out infinite;
}

@keyframes champion-glow {
    0%, 100% { 
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.5),
                    inset 0 0 20px rgba(255, 215, 0, 0.1);
    }
    50% { 
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.8),
                    inset 0 0 30px rgba(255, 215, 0, 0.2);
    }
}

.crown-animation {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.5rem;
    animation: crown-bounce 2s ease-in-out infinite;
}

@keyframes crown-bounce {
    0%, 100% { transform: translateX(-50%) translateY(0) rotate(0deg); }
    25% { transform: translateX(-50%) translateY(-5px) rotate(-5deg); }
    75% { transform: translateX(-50%) translateY(-5px) rotate(5deg); }
}

.fire-text {
    background: linear-gradient(45deg, #FFD700, #FFA500, #FF6347);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: fire-gradient 2s ease-in-out infinite;
    font-weight: 900;
}

@keyframes fire-gradient {
    0%, 100% { filter: hue-rotate(0deg) brightness(1); }
    50% { filter: hue-rotate(10deg) brightness(1.2); }
}




    </style>
</head>
<body>
    <div class="container">
        <!-- ë¡œê·¸ì¸ í™”ë©´ -->
        <div class="login-card" id="loginSection">
            
<div style="text-align: center; margin-bottom: 20px;">
    <img src="images/logo.jpg" alt="ì•„ìì˜ì–´í•™ì›" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover;">
</div>
<h1>ì•„ìì˜ì–´í•™ì›</h1>



            <p>ì„±ì  ì¡°íšŒ ì‹œìŠ¤í…œ</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <label>í•™ìƒ ì´ë¦„</label>
                    <input type="text" id="studentName" placeholder="í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                <div class="form-group">
                    <label>í•™ë¶€ëª¨ ì—°ë½ì²˜ (ë’¤ 4ìë¦¬)</label>
                    <input type="text" id="contactNumber" pattern="\d{4}" maxlength="4" placeholder="0000" required>
                </div>
                <button type="submit" class="btn">ì„±ì  í™•ì¸í•˜ê¸°</button>
            </form>
            
            <div id="loginError" class="error" style="display: none;"></div>
        </div>
        <!-- ëŒ€ì‹œë³´ë“œ -->
        <div class="dashboard" id="dashboardSection">
            <div class="header-card">
                <!-- ì•„ìì˜ì–´ ë¡œê³  ì¶”ê°€ -->
               

<div class="header-logo">
    <img src="images/logo.jpg" alt="AZA" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
    <span class="logo-text">ì•„ìì˜ì–´í•™ì› AZA English</span>
</div>






                <div class="student-info">
                    <div>
                        <div class="student-name" id="displayName">í•™ìƒ ì´ë¦„</div>
                        <div class="student-class" id="displayClass">ì´ˆë“±ë¶€ | 8-12ì›” ì„±ì </div>
                    </div>
                    <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </div>
            <!-- ì›” ì„ íƒ í•„í„° -->
            <div class="filter-section">
                <div class="filter-group">
                    <label>ğŸ“… ì›” ì„ íƒ:</label>
                    <select class="filter-select" id="monthFilter" onchange="filterByMonth()">
                        <option value="all">ì „ì²´</option>
                        <option value="1">1ì›”</option>
                        <option value="2">2ì›”</option>
                        <option value="3">3ì›”</option>
                        <option value="4">4ì›”</option>
                        <option value="5">5ì›”</option>
                        <option value="6">6ì›”</option>
                        <option value="7">7ì›”</option>
                        <option value="8">8ì›”</option>
                        <option value="9">9ì›”</option>
                        <option value="10">10ì›”</option>
                        <option value="11">11ì›”</option>
                        <option value="12">12ì›”</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>í˜„ì¬ í‘œì‹œ:</label>
                    <span id="currentFilter" style="font-weight: 600; color: #667eea;">ì „ì²´ ê¸°ê°„</span>
                </div>
            </div>



<!-- í•™ì› ì „ì²´ ìˆœìœ„ -->
<div class="ranking-section" id="rankingSection">
    <h2 class="ranking-title">ğŸ† ì´ë²ˆ ë‹¬ í•™ì› ì „ì²´ 1ìœ„</h2>
    <div class="ranking-grid">
        <div class="ranking-card">
            <div class="trophy-icon">ğŸ¥‡</div>
            <div class="ranking-label">ì–´íœ˜ 1ìœ„</div>
            <div class="ranking-value" id="vocabTopScore">-</div>
            <div class="ranking-name" id="vocabTopName">-</div>
        </div>
        <div class="ranking-card">
            <div class="trophy-icon">ğŸ¥‡</div>
            <div class="ranking-label">ìŠ¤í  1ìœ„</div>
            <div class="ranking-value" id="spellTopScore">-</div>
            <div class="ranking-name" id="spellTopName">-</div>
        </div>
        <div class="ranking-card">
            <div class="trophy-icon">ğŸ¥‡</div>
            <div class="ranking-label">ë…í•´ 1ìœ„</div>
            <div class="ranking-value" id="readingTopScore">-</div>
            <div class="ranking-name" id="readingTopName">-</div>
        </div>
    </div>
</div>









            <!-- í†µê³„ ì¹´ë“œ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">ğŸ“š ì–´íœ˜ í‰ê· </div>
                    <div class="stat-value" id="vocabAvg">-</div>
                    <div class="stat-detail" id="vocabDetail">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">âœï¸ ìŠ¤í  í‰ê· </div>
                    <div class="stat-value" id="spellAvg">-</div>
                    <div class="stat-detail" id="spellDetail">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ğŸ“– ë…í•´ í‰ê· </div>
                    <div class="stat-value" id="readingAvg">-</div>
                    <div class="stat-detail" id="readingDetail">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">âœ… ì¶œì„ë¥ </div>
                    <div class="stat-value" id="attendanceRate">-</div>
                    <div class="stat-detail" id="attendanceDetail">-</div>
                </div>
            </div>
            <!-- ì¶œì„ ë‹¬ë ¥ -->
            <div class="calendar-container">
                <div class="calendar-header">
                    <h2 class="chart-title">ğŸ“… ì¶œì„ í˜„í™©</h2>
                    <div class="calendar-nav">
                        <button onclick="changeMonth(-1)">â—€ ì´ì „</button>
                        <span id="calendarMonth" style="font-weight: 600; padding: 0 15px;">2024ë…„ 8ì›”</span>
                        <button onclick="changeMonth(1)">ë‹¤ìŒ â–¶</button>
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendarGrid">
                    <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                </div>
                
                <div class="calendar-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4caf50;"></div>
                        <span>ì¶œì„</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f44336;"></div>
                        <span>ê²°ì„</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffc107;"></div>
                        <span>ì§€ê°</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e0e0e0;"></div>
                        <span>ìˆ˜ì—… ì—†ìŒ</span>
                    </div>
                </div>
            </div>
            <!-- ì°¨íŠ¸ -->
            <div class="chart-card">
                <h2 class="chart-title">ğŸ“ˆ ì„±ì  ì¶”ì´</h2>
                <div class="chart-container">
                    <canvas id="scoreChart"></canvas>
                </div>
            </div>
            <!-- ì„±ì  ìƒì„¸ í…Œì´ë¸” -->
            <div class="table-card">
                <h2 class="chart-title">ğŸ“‹ ìƒì„¸ ì„±ì í‘œ</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th>
                                <th>ì¶œì„</th>
                                <th>ì–´íœ˜<br>(94ì )</th>
                                <th>ìŠ¤í <br>(80ì )</th>
                                <th>ë…í•´<br>(80ì )</th>
                            </tr>
                        </thead>
                        <tbody id="scoreTableBody">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        



<!-- ë¡œë”© -->
<div class="loading" id="loadingSection" style="display: none;">
    <div class="loading-container">
        <div class="pulse-loader"></div>
        <h2 class="loading-text">ì„±ì  ë°ì´í„° ì¡°íšŒì¤‘<span class="loading-dots"></span></h2>
        <div class="loading-progress">
            <div class="loading-progress-bar"></div>
        </div>
    </div>
</div>







    </div>
    <script>
        // API URL
        const API_URL = 'https://script.google.com/macros/s/AKfycbyVpOJGyTNxmP-KJU_FPjqJdO_hKoJfBM-zlWaUtWWEoYunRxymvwquGH0d-pNmepWO/exec';
        let chart = null;
        let allData = null; // ì „ì²´ ë°ì´í„° ì €ì¥
        let currentMonth = 8; // í˜„ì¬ í‘œì‹œ ì¤‘ì¸ ë‹¬ë ¥ ì›”
        let currentYear = 2024; // í˜„ì¬ í‘œì‹œ ì¤‘ì¸ ë‹¬ë ¥ ì—°ë„
        
        // ë¡œê·¸ì¸ í¼ ì œì¶œ
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('studentName').value;
            const contact = document.getElementById('contactNumber').value;
            
            if (!name || !contact) {
                showError('ì´ë¦„ê³¼ ì—°ë½ì²˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            await fetchStudentData(name, contact);
        });
        
        // í•™ìƒ ë°˜ íŒë³„ í•¨ìˆ˜ ì¶”ê°€
        function determineClass(studentName) {
            // ì´ë¦„ì— ë”°ë¼ ë°˜ì„ íŒë³„í•˜ëŠ” ë¡œì§
            // ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ë‚˜ APIì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆìŒ
            // ì˜ˆì‹œë¡œ ê°„ë‹¨í•œ ê·œì¹™ ì ìš©
            const elementaryKeywords = ['ì´ˆë“±', 'ì´ˆ'];
            const middleKeywords = ['ì¤‘ë“±', 'ì¤‘', 'ì¤‘í•™'];
            const highKeywords = ['ìˆ˜ëŠ¥', 'ê³ ë“±', 'ê³ '];
            
            // ì‹¤ì œë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•™ìƒ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì•¼ í•¨
            // ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ ì´ë¦„ ê¸°ë°˜ ë˜ëŠ” ëœë¤ ë°°ì •
            const nameLower = studentName.toLowerCase();
            
            // ì„ì‹œ ë¡œì§: ì´ë¦„ì˜ ì²« ê¸€ìë¡œ íŒë³„ (ì‹¤ì œë¡œëŠ” DB ì¡°íšŒ í•„ìš”)
            const charCode = studentName.charCodeAt(0);
            
            if (charCode % 3 === 0) {
                return 'ì´ˆë“±ë¶€';
            } else if (charCode % 3 === 1) {
                return 'ì¤‘ë“±ë¶€';
            } else {
                return 'ìˆ˜ëŠ¥ë¶€';
            }
        }
        
        // í•™ìƒ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function fetchStudentData(name, contact) {
            // ë¡œë”© í‘œì‹œ
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'block';
            
            try {
                const response = await fetch(`${API_URL}?name=${encodeURIComponent(name)}&contact=${contact}`);
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                // ì „ì²´ ë°ì´í„° ì €ì¥
                allData = data;
                
                // í•™ìƒ ë°˜ ì •ë³´ ì¶”ê°€
                allData.studentClass = determineClass(data.student);
                
                // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                displayDashboard(data);
                
                // ë‹¬ë ¥ ì´ˆê¸°í™” (ì²« ë²ˆì§¸ ë°ì´í„°ì˜ ì›”ë¡œ ì„¤ì •)
                if (data.scores && data.scores.length > 0) {
                    const firstDate = new Date(data.scores[0].date);
                    currentMonth = firstDate.getMonth() + 1;
                    currentYear = firstDate.getFullYear();
                    drawCalendar();
                }
                
            } catch (error) {
                document.getElementById('loadingSection').style.display = 'none';
                document.getElementById('loginSection').style.display = 'block';
                showError(error.message || 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ì›”ë³„ í•„í„°ë§
        function filterByMonth() {
            const selectedMonth = document.getElementById('monthFilter').value;
            
            if (selectedMonth === 'all') {
                document.getElementById('currentFilter').textContent = 'ì „ì²´ ê¸°ê°„';
                displayDashboard(allData);
            } else {
                const monthNum = parseInt(selectedMonth);
                document.getElementById('currentFilter').textContent = `${monthNum}ì›”`;
                
                // ì„ íƒí•œ ì›”ì˜ ë°ì´í„°ë§Œ í•„í„°ë§
                const filteredScores = allData.scores.filter(score => {
                    const date = new Date(score.date);
                    return date.getMonth() + 1 === monthNum;
                });
                
                // í•„í„°ë§ëœ ë°ì´í„°ë¡œ ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
                const filteredData = {
                    ...allData,
                    scores: filteredScores,
                    averages: calculateAverages(filteredScores),
                    attendDays: filteredScores.filter(s => s.attendance === 'ì¶œì„').length,
                    totalDays: filteredScores.length
                };
                
                displayDashboard(filteredData);
            }
        }
        
        // í‰ê·  ê³„ì‚° í•¨ìˆ˜
        function calculateAverages(scores) {
            const vocabScores = scores.filter(s => s.vocab).map(s => s.vocab);
            const spellScores = scores.filter(s => s.spell).map(s => s.spell);
            const readingScores = scores.filter(s => s.reading).map(s => s.reading);
            
            return {
                vocab: vocabScores.length > 0 ? vocabScores.reduce((a, b) => a + b, 0) / vocabScores.length : 0,
                spell: spellScores.length > 0 ? spellScores.reduce((a, b) => a + b, 0) / spellScores.length : 0,
                reading: readingScores.length > 0 ? readingScores.reduce((a, b) => a + b, 0) / readingScores.length : 0
            };
        }
        
        // ë‹¬ë ¥ ê·¸ë¦¬ê¸°
        function drawCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            // ì›” í‘œì‹œ ì—…ë°ì´íŠ¸
            document.getElementById('calendarMonth').textContent = `${currentYear}ë…„ ${currentMonth}ì›”`;
            
            // ìš”ì¼ í—¤ë”
            const days = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                grid.appendChild(dayHeader);
            });
            
            // í•´ë‹¹ ì›”ì˜ ì²« ë‚ ê³¼ ë§ˆì§€ë§‰ ë‚ 
            const firstDay = new Date(currentYear, currentMonth - 1, 1);
            const lastDay = new Date(currentYear, currentMonth, 0);
            const startPadding = firstDay.getDay();
            
            // ì¶œì„ ë°ì´í„°ë¥¼ ë‚ ì§œë³„ë¡œ ë§¤í•‘
            const attendanceMap = {};
            if (allData && allData.scores) {
                allData.scores.forEach(score => {
                    const date = new Date(score.date);
                    if (date.getMonth() + 1 === currentMonth && date.getFullYear() === currentYear) {
                        attendanceMap[date.getDate()] = score.attendance;
                    }
                });
            }
            
            // ë¹ˆ ì¹¸ ì±„ìš°ê¸° (ì›” ì‹œì‘ ì „)
            for (let i = 0; i < startPadding; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                grid.appendChild(emptyDay);
            }
            
            // ë‚ ì§œ ì±„ìš°ê¸°
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                // ì¶œì„ ìƒíƒœì— ë”°ë¥¸ í´ë˜ìŠ¤ ì¶”ê°€
                const attendance = attendanceMap[day];
                if (attendance === 'ì¶œì„') {
                    dayElement.classList.add('attend');
                } else if (attendance === 'ê²°ì„') {
                    dayElement.classList.add('absent');
                } else if (attendance === 'ì§€ê°') {
                    dayElement.classList.add('late');
                } else {
                    dayElement.classList.add('no-class');
                }
                
                // íˆ´íŒ ì¶”ê°€
                if (attendance) {
                    dayElement.title = `${currentMonth}ì›” ${day}ì¼: ${attendance}`;
                }
                
                grid.appendChild(dayElement);
            }
        }
        
        // ë‹¬ë ¥ ì›” ë³€ê²½
        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 12) {
                currentMonth = 1;
                currentYear++;
            } else if (currentMonth < 1) {
                currentMonth = 12;
                currentYear--;
            }
            drawCalendar();
        }
        
        // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
        function displayDashboard(data) {
            // ë¡œë”© ìˆ¨ê¸°ê³  ëŒ€ì‹œë³´ë“œ í‘œì‹œ
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('dashboardSection').style.display = 'block';
            
            // í•™ìƒ ì´ë¦„
            document.getElementById('displayName').textContent = data.student;
            
            // í•™ìƒ ë°˜ ì •ë³´ í‘œì‹œ (ì´ˆë“±ë¶€/ì¤‘ë“±ë¶€/ìˆ˜ëŠ¥ë¶€)
            const studentClass = data.studentClass || determineClass(data.student);
            const dateRange = data.scores && data.scores.length > 0 
                ? `${new Date(data.scores[0].date).getMonth() + 1}-${new Date(data.scores[data.scores.length - 1].date).getMonth() + 1}ì›” ì„±ì `
                : 'ì„±ì ';
            document.getElementById('displayClass').textContent = `${studentClass} | ${dateRange}`;
            


document.getElementById('displayClass').textContent = `${studentClass} | ${dateRange}`;

// ========== ì—¬ê¸°ì— ì¶”ê°€ ì‹œì‘ ==========
// í˜„ì¬ ì›” í‘œì‹œ ë° ìˆœìœ„ ë°ì´í„° ì„¤ì •
const currentDate = new Date();
const currentMonthDisplay = currentDate.getMonth() + 1;
document.querySelector('.ranking-title').textContent = `ğŸ† ${currentMonthDisplay}ì›” í•™ì› ì „ì²´ 1ìœ„`;

// ì„ì‹œ ìˆœìœ„ ë°ì´í„°
const rankingData = {
    vocab: { score: 98.5, name: 'ê¹€ë¯¼ìˆ˜' },
    spell: { score: 95.0, name: 'ì´ì„œì—°' },
    reading: { score: 96.5, name: 'ë°•ì¤€í˜¸' }
};

// 1ìœ„ í‘œì‹œ
document.getElementById('vocabTopScore').textContent = rankingData.vocab.score + 'ì ';
document.getElementById('vocabTopName').textContent = rankingData.vocab.name;
document.getElementById('spellTopScore').textContent = rankingData.spell.score + 'ì ';
document.getElementById('spellTopName').textContent = rankingData.spell.name;
document.getElementById('readingTopScore').textContent = rankingData.reading.score + 'ì ';
document.getElementById('readingTopName').textContent = rankingData.reading.name;

// ë³¸ì¸ì´ 1ìœ„ì¸ ê²½ìš° íŠ¹ë³„ íš¨ê³¼
const rankingCards = document.querySelectorAll('.ranking-card');
if (data.student === rankingData.vocab.name) {
    rankingCards[0].classList.add('is-champion');
    rankingCards[0].innerHTML += '<div class="crown-animation">ğŸ‘‘</div>';
    document.getElementById('vocabTopName').classList.add('fire-text');
}
if (data.student === rankingData.spell.name) {
    rankingCards[1].classList.add('is-champion');
    rankingCards[1].innerHTML += '<div class="crown-animation">ğŸ‘‘</div>';
    document.getElementById('spellTopName').classList.add('fire-text');
}
if (data.student === rankingData.reading.name) {
    rankingCards[2].classList.add('is-champion');
    rankingCards[2].innerHTML += '<div class="crown-animation">ğŸ‘‘</div>';
    document.getElementById('readingTopName').classList.add('fire-text');
}
// ========== ì—¬ê¸°ì— ì¶”ê°€ ë ==========

// í‰ê·  ì ìˆ˜
document.getElementById('vocabAvg').textContent = data.averages.vocab.toFixed(1);



            // í‰ê·  ì ìˆ˜
            document.getElementById('vocabAvg').textContent = data.averages.vocab.toFixed(1);
            document.getElementById('spellAvg').textContent = data.averages.spell.toFixed(1);
            document.getElementById('readingAvg').textContent = data.averages.reading.toFixed(1);
            
            // ìµœê³ /ìµœì € ì ìˆ˜ ê³„ì‚°
            const vocabScores = data.scores.filter(s => s.vocab).map(s => s.vocab);
            const spellScores = data.scores.filter(s => s.spell).map(s => s.spell);
            const readingScores = data.scores.filter(s => s.reading).map(s => s.reading);
            
            if (vocabScores.length > 0) {
                document.getElementById('vocabDetail').textContent = 
                    `ìµœê³  ${Math.max(...vocabScores)}ì  | ìµœì € ${Math.min(...vocabScores)}ì `;
            } else {
                document.getElementById('vocabDetail').textContent = 'ë°ì´í„° ì—†ìŒ';
            }
            
            if (spellScores.length > 0) {
                document.getElementById('spellDetail').textContent = 
                    `ìµœê³  ${Math.max(...spellScores)}ì  | ìµœì € ${Math.min(...spellScores)}ì `;
            } else {
                document.getElementById('spellDetail').textContent = 'ë°ì´í„° ì—†ìŒ';
            }
            
            if (readingScores.length > 0) {
                document.getElementById('readingDetail').textContent = 
                    `ìµœê³  ${Math.max(...readingScores)}ì  | ìµœì € ${Math.min(...readingScores)}ì `;
            } else {
                document.getElementById('readingDetail').textContent = 'ë°ì´í„° ì—†ìŒ';
            }
            
            // ì¶œì„ë¥ 
            const attendanceRate = data.totalDays > 0 ? (data.attendDays / data.totalDays * 100).toFixed(0) : 0;
            document.getElementById('attendanceRate').textContent = attendanceRate + '%';
            document.getElementById('attendanceDetail').textContent = 
                `${data.attendDays}ì¼ ì¶œì„ / ${data.totalDays}ì¼`;
            
            // ì°¨íŠ¸ ê·¸ë¦¬ê¸°
            drawChart(data.scores);
            
            // í…Œì´ë¸” ì±„ìš°ê¸°
            fillTable(data.scores);
        }
        
        // ì°¨íŠ¸ ê·¸ë¦¬ê¸° - ì  í¬ê¸° ì¶•ì†Œ
        function drawChart(scores) {
            const ctx = document.getElementById('scoreChart').getContext('2d');
            
            // ë‚ ì§œ í¬ë§·íŒ…
            const labels = scores.map(s => {
                const date = new Date(s.date);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (chart) {
                chart.destroy();
            }
            
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'ì–´íœ˜',
                            data: scores.map(s => s.vocab),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            spanGaps: true,
                            borderWidth: 2, // ì„  ë‘ê»˜ ì¤„ì„
                            pointRadius: 3, // ì  í¬ê¸° ì¤„ì„ (5 -> 3)
                            pointHoverRadius: 5, // í˜¸ë²„ì‹œ ì  í¬ê¸° ì¤„ì„ (7 -> 5)
                            pointBackgroundColor: '#667eea',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 1
                        },
                        {
                            label: 'ìŠ¤í ',
                            data: scores.map(s => s.spell),
                            borderColor: '#764ba2',
                            backgroundColor: 'rgba(118, 75, 162, 0.1)',
                            tension: 0.4,
                            spanGaps: true,
                            borderWidth: 2, // ì„  ë‘ê»˜ ì¤„ì„
                            pointRadius: 3, // ì  í¬ê¸° ì¤„ì„ (5 -> 3)
                            pointHoverRadius: 5, // í˜¸ë²„ì‹œ ì  í¬ê¸° ì¤„ì„ (7 -> 5)
                            pointBackgroundColor: '#764ba2',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 1
                        },
                        {
                            label: 'ë…í•´',
                            data: scores.map(s => s.reading),
                            borderColor: '#f093fb',
                            backgroundColor: 'rgba(240, 147, 251, 0.1)',
                            tension: 0.4,
                            spanGaps: true,
                            borderWidth: 2, // ì„  ë‘ê»˜ ì¤„ì„
                            pointRadius: 3, // ì  í¬ê¸° ì¤„ì„ (5 -> 3)
                            pointHoverRadius: 5, // í˜¸ë²„ì‹œ ì  í¬ê¸° ì¤„ì„ (7 -> 5)
                            pointBackgroundColor: '#f093fb',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            min: 0,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                callback: function(value) {
                                    return value + 'ì ';
                                },
                                font: {
                                    size: 11 // í°íŠ¸ í¬ê¸° ì¤„ì„
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)' // ê·¸ë¦¬ë“œ ìƒ‰ìƒ ì—°í•˜ê²Œ
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 10 // í°íŠ¸ í¬ê¸° ì¤„ì„
                                },
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 10, // íŒ¨ë”© ì¤„ì„
                                font: {
                                    size: 12 // ë²”ë¡€ í°íŠ¸ í¬ê¸° ì¤„ì„
                                },
                                usePointStyle: true, // ì  ìŠ¤íƒ€ì¼ ì‚¬ìš©
                                boxWidth: 6 // ë²”ë¡€ ì•„ì´ì½˜ í¬ê¸° ì¤„ì„
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 12
                            },
                            bodyFont: {
                                size: 11
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + 'ì ';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // í…Œì´ë¸” ì±„ìš°ê¸° - ê°„ì†Œí™”ëœ ë²„ì „
        function fillTable(scores) {
            const tbody = document.getElementById('scoreTableBody');
            tbody.innerHTML = '';
            
            scores.forEach(score => {
                const date = new Date(score.date);
                const dateStr = `${date.getMonth() + 1}/${date.getDate()}`; // ë‚ ì§œ í‘œì‹œ ê°„ì†Œí™”
                
                // í†µê³¼ ì—¬ë¶€ í™•ì¸
                const vocabPass = score.vocab >= 94;
                const spellPass = score.spell >= 80;
                const readingPass = score.reading >= 80;
                
                const row = `
                    <tr>
                        <td>${dateStr}</td>
                        <td>${score.attendance}</td>
                        <td>${score.vocab ? `<span class="score-badge ${vocabPass ? 'score-pass' : 'score-fail'}">${score.vocab}ì ${vocabPass ? 'âœ“' : 'âœ—'}</span>` : '-'}</td>
                        <td>${score.spell ? `<span class="score-badge ${spellPass ? 'score-pass' : 'score-fail'}">${score.spell}ì ${spellPass ? 'âœ“' : 'âœ—'}</span>` : '-'}</td>
                        <td>${score.reading ? `<span class="score-badge ${readingPass ? 'score-pass' : 'score-fail'}">${score.reading}ì ${readingPass ? 'âœ“' : 'âœ—'}</span>` : '-'}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }
        
        // ì—ëŸ¬ í‘œì‹œ
        function showError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }
        
        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            document.getElementById('dashboardSection').style.display = 'none';
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('loginForm').reset();
            allData = null;
        }
    </script>
</body>
</html>